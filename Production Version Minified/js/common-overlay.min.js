/*
 * @author: Jatin Marwah (https://github.com/jatinmarwah)
 * @License: The MIT License (MIT)
 * @Release Date: 19 July 2014
 */
;(function(c,a,e,g){var b=e("body"),f=e(a);e.fn.overlay=function(h){var j=this,i=h||{},k=e.extend({},e.fn.overlay.defaults,i),d={_options:k,_init:function(){k.ajax=k.ajax||(e(j).data("ajax")||false);k.inline=k.inline||(e(j).data("inline")||false);d._open();d._closeonEscape();d._close()},_debug:function(l){if(k.debug&&typeof console!=="undefined"){console.log(l)}},_open:function(){d._debug(k.inline);d._debug(k.ajax);b.append(d._getTemplate());d._loading();if(k.ajax&&!k.inline){d._debug("you opted ajax method");if(!k.ajax){d._debug("ajax url not found");return}d._fireAjax(k.ajax)}else{if(k.inline){d._debug("you opted inline method");if(e(k.inline).length==0){d._debug("Inline content not found")}d._inline(k.inline)}else{d._debug("no method found - ajax or inline")}}k.callback.call(this)},_fireAjax:function(l){e.ajax({url:l,async:false,cache:false,success:function(n,o,m){d._append(n)}})},_inline:function(m){var l=e(m).clone();d._append(l)},_append:function(l){e(k.loadingClass).remove();e(k.innerWrapper).append(l)},_getTemplate:function(){return k.template},_loading:function(){e(k.innerWrapper).css("background-color",k.colors.background);e(k.innerWrapper).find(k.closeBtn).css("color",k.colors.closeButton);e(k.innerWrapper).find(k.loadingClass).css("color",k.colors.loading);e(k.outerWrapper).find(".overlay").css("opacity",k.colors.opacity);e(k.loadingClass).append(k.loadingText)},_closeonEscape:function(){if(k.closeonEscape){f.bind("keypress.myEvent keydown.myEvent",function(l){if((l.which||l.keyCode)===27){l.preventDefault();d._removeWrapper()}})}},_close:function(){e(k.closeBtn).on("click",function(){d._removeWrapper()})},_removeWrapper:function(){e(k.outerWrapper).remove();f.unbind("keypress.myEvent keydown.myEvent")}};return d._init()};e.fn.overlay.defaults={debug:false,template:'<div class=\'outer-overlay\' id="outer-overlay"><div class="overlay"></div><div class=\'inner-overlay modal\' id="inner-overlay"><a title="Close" class="close" href="javascript:;">X</a><div class=\'loading\' style=\'font-size:19px\'></div></div></div>',closeBtn:".close",outerWrapper:".outer-overlay",innerWrapper:".inner-overlay",loadingClass:".loading",loadingText:"loading...",closeonEscape:true,colors:{closeButton:"#fff",background:"none",loading:"#fff",opacity:"0.7"},callback:function(){}}}(window,document,jQuery));